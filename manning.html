<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Manning Schedule</title>

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:linear-gradient(135deg,#00b894,#0984e3);
}

.navbar{
  position:relative;
  z-index:5;
  display:flex;
  align-items:center;
  justify-content:flex-start;
  flex-wrap:wrap;
  padding:10px 20px;
  background:rgba(238,237,237,0.35);
  backdrop-filter:blur(6px);
}

.navbar button{
  background:#74b9ff;
  border:none;
  padding:10px;
  border-radius:8px;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
  flex:1;
  margin:3px;
}

.navbar button:hover{background:#0984e3}

.logo{
  height:90px;
  margin-right:30px;
  cursor:pointer;
}

.section{
  background:#fff;
  margin:10px;
  padding:20px;
  border-radius:12px;
  box-shadow:0 8px 20px rgba(0,0,0,.2);
  position:relative;
}

h2,h3{text-align:center}

#toggleTable{
  position:absolute;
  top:10px;
  left:10px;
  background:#0984e3;
  color:#fff;
  border:none;
  padding:6px 12px;
  border-radius:5px;
  cursor:pointer;
}

#toggleTable:hover{background:#0652dd}

.month-control{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:15px;
  margin-bottom:15px;
}

.month-control button{
  background:#0984e3;
  color:#fff;
  border:none;
  padding:6px 12px;
  border-radius:5px;
  cursor:pointer;
}

.month-control span{
  font-weight:bold;
  font-size:16px;
}

.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:4px;
  margin-bottom:15px;
}

.calendar div{
  border:1px solid #ccc;
  min-height:60px;
  padding:4px;
  display:flex;
  flex-direction:column;
  align-items:center;
  background:#f9f9f9;
  border-radius:6px;
  box-shadow:0 1px 3px rgba(0,0,0,.1);
  font-size:13px;
}

.calendar div:hover{background:#e0f7fa}

.calendar strong{
  font-size:14px;
  margin-bottom:2px;
}

.calendar .note{
  flex:1;
  border-top:1px dashed #ccc;
  padding:2px;
  font-size:12px;
  overflow:auto;
  width:90%;
  min-height:20px;
  background:#fff;
  border-radius:4px;
  margin-top:2px;
  text-align:center;
}

.calendar .day-header{
  font-weight:bold;
  text-align:center;
  padding:6px 0;
  background:#74b9ff;
  color:#fff;
  border-radius:4px;
}

#trackerTable{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
  font-size:13px;
  display:none;
}

#trackerTable th,#trackerTable td{
  border:1px solid #aaa;
  padding:4px;
  text-align:center;
}

#trackerTable th{background:#f2f2f2}

input.editable{
  width:100%;
  border:none;
  background:transparent;
  text-align:center;
  font-size:13px;
}

button.action{
  background:#0984e3;
  color:#fff;
  border:none;
  padding:6px 12px;
  border-radius:5px;
  cursor:pointer;
  margin-top:5px;
}

button.action:hover{background:#0652dd}
</style>
</head>

<body>

<div class="navbar">
  <img src="VHBC.png" class="logo" onclick="location.href='index.html'">
  <button onclick="location.href='index.html'">Home</button>
  <button onclick="location.href='report.html'">Report</button>
  <button onclick="location.href='tripping.html'">Tripping & Sales</button>
  <button onclick="location.href='manning.html'">Manning</button>
  <button onclick="location.href='activities.html'">Activities</button>
  <button onclick="location.href='lot-calculator.html'">Lot Calculator</button>
</div>

<div class="section">
  <h2>IN-HOUSE MANNING</h2>

  <button id="toggleTable" onclick="toggleTable()">Show Tracker</button>

  <div class="month-control">
    <button onclick="changeMonth(-1)">◀ Previous</button>
    <span id="monthLabel"></span>
    <button onclick="changeMonth(1)">Next ▶</button>
  </div>

  <div class="calendar" id="calendar"></div>

  <h3 id="trackerHeader" style="display:none;">IN-HOUSE MANNING</h3>

  <table id="trackerTable">
    <tr>
      <th>DATE</th>
      <th>ASSIGN MANNING</th>
      <th>DUTY</th>
      <th>STATUS</th>
      <th>TEAM ROTATION</th>
      <th>CLIENT NAME</th>
      <th>REMARKS</th>
    </tr>
  </table>

  <button class="action" onclick="addRow()">Add Row</button>
</div>

<script>
let currentDate = new Date();

function toggleTable(){
  const t=document.getElementById("trackerTable");
  const h=document.getElementById("trackerHeader");
  const b=document.getElementById("toggleTable");
  const show=t.style.display==="none";
  t.style.display=show?"table":"none";
  h.style.display=show?"block":"none";
  b.textContent=show?"Hide Tracker":"Show Tracker";
}

function saveData(){
  const table=document.getElementById("trackerTable");
  const data=[];
  for(let r=1;r<table.rows.length;r++){
    const row=[];
    for(let c=0;c<7;c++){
      row.push(table.rows[r].cells[c].querySelector("input").value);
    }
    data.push(row);
  }
  localStorage.setItem("trackerTable",JSON.stringify(data));

  const notes={};
  document.querySelectorAll(".note-cell").forEach(d=>{
    notes[d.dataset.date]=d.querySelector(".note").innerHTML;
  });
  localStorage.setItem("calendarNotes",JSON.stringify(notes));
}

function loadData(){
  const table=document.getElementById("trackerTable");
  const data=JSON.parse(localStorage.getItem("trackerTable")||"[]");
  while(table.rows.length>1)table.deleteRow(1);
  data.forEach(r=>addRow(r));

  const notes=JSON.parse(localStorage.getItem("calendarNotes")||"{}");
  document.querySelectorAll(".note-cell").forEach(d=>{
    d.querySelector(".note").innerHTML=notes[d.dataset.date]||"";
  });
}

function addRow(values=[]){
  const row=document.getElementById("trackerTable").insertRow();
  for(let i=0;i<7;i++){
    const c=row.insertCell();
    const iEl=document.createElement("input");
    iEl.className="editable";
    iEl.value=values[i]||"";
    iEl.oninput=saveData;
    c.appendChild(iEl);
  }
  saveData();
}

function buildCalendar(){
  const cal=document.getElementById("calendar");
  cal.innerHTML="";
  const y=currentDate.getFullYear();
  const m=currentDate.getMonth();
  document.getElementById("monthLabel").textContent=
    currentDate.toLocaleString("default",{month:"long"})+" "+y;

  ["SUN","MON","TUE","WED","THU","FRI","SAT"].forEach(d=>{
    const h=document.createElement("div");
    h.className="day-header";
    h.textContent=d;
    cal.appendChild(h);
  });

  const first=new Date(y,m,1).getDay();
  const days=new Date(y,m+1,0).getDate();
  for(let i=0;i<first;i++)cal.appendChild(document.createElement("div"));

  const notes=JSON.parse(localStorage.getItem("calendarNotes")||"{}");
  for(let d=1;d<=days;d++){
    const cell=document.createElement("div");
    cell.className="note-cell";
    const key=`${d}-${m}-${y}`;
    cell.dataset.date=key;
    cell.innerHTML=`<strong>${d}</strong><div class="note" contenteditable="true">${notes[key]||""}</div>`;
    cell.querySelector(".note").addEventListener("input",saveData);
    cal.appendChild(cell);
  }
}

function changeMonth(step){
  currentDate.setMonth(currentDate.getMonth()+step);
  buildCalendar();
  loadData();
}

buildCalendar();
loadData();
</script>

</body>
</html>
